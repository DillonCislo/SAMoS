# * *************************************************************
# *  
# *   Active Particles on Curved Spaces (APCS)
# *   
# *   Author: Rastko Sknepnek
# *  
# *   Division of Physics
# *   School of Engineering, Physics and Mathematics
# *   University of Dundee
# *   
# *   (c) 2013
# *   
# *   This program cannot be used, copied, or modified without
# *   explicit permission of the author.
# * 
# * ************************************************************** 

#
#  Simulation of N=1000 active particles interacting only via Vicsek 
#  type alignement interaction.
#  


# All runtime messages will be sent to file messages.msg
messages messages.msg

# Every simulation requires a box
# "fixed" means that no periodic boundary is applied (irrelevant here due to spherical geometry)
# box is cubic with size 30x30x30 (Lennard-Jones units) and spans from -15 to 15 in 
# each direction 
box fixed { lx = 30.0;  ly = 30.0;  lz = 30.0 }

# We read in particle positions from file sphere.dat (generated by tools in utils directory)
input sphere.dat

# We set the neighbour list with cutoff distance 1.5 and padding distance of 0.5
nlist { rcut = 2.5; pad = 0.5 }

# In following we define different data outputs

# Output particle velocities. Base name of the file is sphere_test
# File extension will we '.vel'. Output will be generated every 10000 time steps
# staring from the step 0. Each snapshots will be stored in a separate file (keyword 'multi')
# with name sphere_test_[time_step].vel (e.g., sphere_test_0000010000.vel)
# and each file with contain a header with the description of its content
dump vicsek_sphere { type=velocity; start=0; freq=10000; multi; header }

# Same as above, but the format will be XYZ and file extension '.xyz'
dump vicsek_sphere { type=xyz; start=0; freq=10000; multi; header }

# In order to generate a trajectory, we output coordinates every 1000 time steps
# In this case all snapshots will be stored in one file 'sphere_test.dcd'
dump vicsek_sphere { type=dcd; start=0; freq=1000  }

# Finally, every 10000 steps we generate a separate file that contains only 
# particle coordinates (and the header)
dump vicsek_sphere { type=full; start=0; freq=10000; multi; coordinate; header  }


# We constrain all particles to move only on the surface of a sphere if radius R = 3
constraint sphere { R = 5.0 }


# All particles are interacting via Viscke type alignment. 
# v0 = 1.0 (velocity units)
pair_potential vicsek { v0 = 1.0 }

pair_potential soft { k = 5.0 }

# Integrate equations of motion using Viscek dynamics.
# seed is the initial seed for the random number generator
# dt is the integrator time step (in Lennard-Jones units) - not used here but HAS TO be included due to limitations in the code
# mu is particle mobility
# eta controls the width of the random noise potential
integrator vicsek { dt=1.0; seed = 1;  mu = 1.0; eta = 0.0 }

# Finally, we run simulation for 100,000 time steps
run 100000


